const icons = {
  search: {
    viewBox: `0 0 512 512`,
    paths: [
      {
        d: `M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z`
      }
    ]
  },
  spinner: {
    viewBox: `0 0 1024 1024`,
    paths: [
      {
        d: `M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z`
      }
    ]
  },
  bars: {
    viewBox: `0 0 448 512`,
    paths: [
      {
        d: `M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z`
      }
    ]
  },
  times: {
    viewBox: `0 0 352 512`,
    paths: [
      {
        d: `M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z`
      }
    ]
  },
  sun: {
    viewBox: `0 0 512 512`,
    paths: [
      {
        d: `M392 256a136.003 136.003 0 01-83.955 125.648 136.009 136.009 0 01-148.212-29.481 136.01 136.01 0 01-29.481-148.212A136.003 136.003 0 01256 120a136.154 136.154 0 01136 136zM256 88a16.002 16.002 0 0016-16V56a16.002 16.002 0 00-16-16 16.002 16.002 0 00-16 16v16a16.002 16.002 0 0016 16zm-141.42 49.206a15.994 15.994 0 0017.547 3.656 16.01 16.01 0 005.245-3.49 16.01 16.01 0 004.685-11.431 16.01 16.01 0 00-4.853-11.361l-11.314-11.314a16.002 16.002 0 00-22.753-.127 15.987 15.987 0 00-4.686 11.403 16 16 0 004.813 11.35l11.316 11.314zM72 240H56a16.002 16.002 0 00-16 16 16.002 16.002 0 0016 16h16a16.002 16.002 0 0016-16 16.002 16.002 0 00-16-16zm42.58 134.794l-11.314 11.314a16.002 16.002 0 00-.127 22.753 15.99 15.99 0 0011.403 4.686 15.986 15.986 0 0011.35-4.813l11.314-11.314a16 16 0 00-22.626-22.626zM256 424a16.004 16.004 0 00-11.314 4.686A16.004 16.004 0 00240 440v16c0 4.243 1.686 8.313 4.686 11.314a16.004 16.004 0 0022.628 0c3-3.001 4.686-7.071 4.686-11.314v-16c0-4.243-1.686-8.313-4.686-11.314A16.004 16.004 0 00256 424zm141.42-49.206a16 16 0 00-22.626 22.626l11.314 11.314a16 16 0 0022.626-22.626l-11.314-11.314zM456 240h-16a16.004 16.004 0 00-11.314 4.686 16.004 16.004 0 000 22.628c3.001 3 7.071 4.686 11.314 4.686h16c4.243 0 8.313-1.686 11.314-4.686a16.004 16.004 0 000-22.628A16.004 16.004 0 00456 240zm-69.892-98.108a15.951 15.951 0 0011.314-4.686l11.312-11.314a16.006 16.006 0 004.813-11.35 16.002 16.002 0 00-9.918-14.889 16 16 0 00-17.521 3.613l-11.314 11.314a16.002 16.002 0 002.426 24.615 15.998 15.998 0 008.888 2.697z`
      }
    ]
  },
  moon: {
    viewBox: `0 0 512 512`,
    paths: [
      {
        fill: `#614CF6`,
        d: `M256 64h8.384a160.004 160.004 0 00-26.075 203.109 160 160 0 00195.035 62.406 191.995 191.995 0 01-158.637 117.406A192.004 192.004 0 0164.275 265.195 192.001 192.001 0 01256 63.83V64z`
      },
      {
        fill: `#F6A54C`,
        d: `M355.5 71c0 13.26 5.215 25.978 14.498 35.355C379.281 115.732 391.872 121 405 121c-13.128 0-25.719 5.268-35.002 14.645-9.283 9.376-14.498 22.094-14.498 35.355 0-13.261-5.215-25.979-14.498-35.355C331.719 126.268 319.128 121 306 121c13.128 0 25.719-5.268 35.002-14.645C350.285 96.978 355.5 84.261 355.5 71zM418 196a30 30 0 0030 30 30 30 0 00-30 30 30 30 0 00-30-30 30 30 0 0030-30z`
      },
    ]
  }
};

const getRotateDegree = (viewBox) => {
  const viewBoxArray = viewBox.split(` `);

  return `${+viewBoxArray[2] / 2} ${+viewBoxArray[3] / 2}`;
};

export default class Icon{
  constructor({
    className,
    isFocusable = false,
    icon,
    isSpin = false,
    onClick,
    rotate,
    target
  }){
    this.$svg = document.createElementNS(`http://www.w3.org/2000/svg`, `svg`);
    this.$svg.classList.add(`icon`);
    this.$svg.setAttribute(`width`, `1em`);
    this.$svg.setAttribute(`height`, `1em`);
    this.$svg.setAttribute(`fill`, `currentColor`);
    this.$svg.setAttribute(`focusable`, isFocusable);
    this.className = className;
    this.isFocusable = isFocusable;
    this.icon = icon;
    this.isSpin = isSpin;
    this.onClick = onClick;
    if(this.onClick){
      this.$svg.addEventListener(`click`, this.onClick);
    }
    this.rotate = rotate;

    target.appendChild(this.$svg);
    this.render();
  }

  get dom(){
    return this.$svg;
  }
  
  render(){
    this.$svg.innerHTML = null;

    if(this.className){
      this.$svg.classList.add(this.className);
    }
    if(this.icon){
      const iconData = icons[this.icon];
      const { viewBox, paths } = iconData;

      this.$svg.setAttribute(`viewBox`, viewBox);
      paths.forEach((pathData) => {
        const $path = document.createElementNS(`http://www.w3.org/2000/svg`, `path`);
        const { fill, d } = pathData;

        if(fill){
          $path.setAttribute(`fill`, fill);
        }
        if(d){
          $path.setAttribute(`d`, d);
        }
        if(this.rotate){
          $path.setAttribute(`transform`, `rotate(${this.rotate} ${getRotateDegree(viewBox)})`)
        }
        this.$svg.appendChild($path);
      });
    }
    if(this.isSpin){
      this.$svg.classList.add(`icon-spin`);
    }else{
      this.$svg.classList.remove(`icon-spin`);
    }
  }
}